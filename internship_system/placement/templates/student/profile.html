{% extends base_template %}

{% block content %}
<div class="profile-wrapper">

  {% if error %}
    <div class="alert">
      {{ error }}
    </div>
  {% else %}

  <h2 class="page-title">My Profile</h2>

  <!-- Academic Information -->
  <div class="profile-card">
    <h3>Academic Information</h3>

    <table class="academic-info">
      <tr>
        <th>User ID</th>
        <td class="highlight">{{ student.user.id }}</td>
      </tr>
      <tr>
        <th>Name</th>
        <td class="highlight">{{ student.user.username }}</td>
      </tr>
      <tr>
        <th>Email</th>
        <td>{{ student.user.email }}</td>
      </tr>
      <tr>
        <th>Program</th>
        <td>{{ student.program }}</td>
      </tr>
      <tr>
        <th>Semester</th>
        <td>{{ student.semester }}</td>
      </tr>
      <tr>
        <th>Academic Supervisor</th>
        <td>
          {% if student.academic_supervisor %}
            {{ student.academic_supervisor.user.username }}
          {% else %}
            <em>Not Assigned</em>
          {% endif %}
        </td>
      </tr>
    </table>

    <div class="profile-actions">
      <!-- Show edit links only for the student owner -->
      {% if is_owner %}
          <a href="{% url 'update_email' %}" class="btn">Update Email</a>
          <a href="{% url 'upload_document' %}" class="btn secondary">Upload Document</a>
      {% endif %}
    </div>
  </div>

  <!-- Uploaded Documents -->
  <h3 class="section-title">Uploaded Documents</h3>

  {% for doc in documents %}
    <table class="document-table">
      <tr>
        <th>Document</th>
        <td>
          {% if doc.file %}
            <a href="{{ doc.file.url }}" target="_blank">View File</a>
          {% else %}
            <span>No file uploaded</span>
          {% endif %}
        </td>
      </tr>

      <tr>
        <td colspan="2" class="document-actions">
          {% if is_owner %}
            <a href="{% url 'edit_document' doc.id %}" class="edit-btn">Edit</a>
            <a href="{% url 'delete_document' doc.id %}" class="delete-btn">Delete</a>
          {% endif %}
        </td>
      </tr>
    </table>
  {% empty %}
    <p class="empty-text">No documents uploaded.</p>
  {% endfor %}

  {% endif %}
</div>
{% endblock %}
